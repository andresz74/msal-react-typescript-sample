{"ast":null,"code":"var _jsxFileName = \"/Users/andresz/Sandbox/reactjs/msal-react-typescript-sample/src/pages/Profile.tsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\"; // Msal imports\n\nimport { MsalAuthenticationTemplate, useMsal } from \"@azure/msal-react\";\nimport { InteractionStatus, InteractionType, InteractionRequiredAuthError } from \"@azure/msal-browser\";\nimport { loginRequest } from \"../authConfig\"; // Sample app imports\n\nimport { ProfileData } from \"../ui-components/ProfileData\";\nimport { Loading } from \"../ui-components/Loading\";\nimport { ErrorComponent } from \"../ui-components/ErrorComponent\";\nimport { callMsGraph } from \"../utils/MsGraphApiCall\"; // Material-ui imports\n\nimport Paper from \"@material-ui/core/Paper\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ProfileContent = () => {\n  _s();\n\n  const {\n    instance,\n    inProgress\n  } = useMsal();\n  const [graphData, setGraphData] = useState(null);\n  useEffect(() => {\n    if (!graphData && inProgress === InteractionStatus.None) {\n      callMsGraph().then(response => setGraphData(response)).catch(e => {\n        if (e instanceof InteractionRequiredAuthError) {\n          instance.acquireTokenRedirect({ ...loginRequest,\n            account: instance.getActiveAccount()\n          });\n        }\n      });\n    }\n  }, [inProgress, graphData, instance]);\n  return /*#__PURE__*/_jsxDEV(Paper, {\n    children: graphData ? /*#__PURE__*/_jsxDEV(ProfileData, {\n      graphData: graphData\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 27\n    }, this) : null\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ProfileContent, \"j8M1Al6myzEsF3QekGxAeN8GrWo=\", false, function () {\n  return [useMsal];\n});\n\n_c = ProfileContent;\nexport function Profile() {\n  const authRequest = { ...loginRequest\n  };\n  return /*#__PURE__*/_jsxDEV(MsalAuthenticationTemplate, {\n    interactionType: InteractionType.Redirect,\n    authenticationRequest: authRequest,\n    errorComponent: ErrorComponent,\n    loadingComponent: Loading,\n    children: /*#__PURE__*/_jsxDEV(ProfileContent, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 9\n  }, this);\n}\n_c2 = Profile;\n;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ProfileContent\");\n$RefreshReg$(_c2, \"Profile\");","map":{"version":3,"names":["useEffect","useState","MsalAuthenticationTemplate","useMsal","InteractionStatus","InteractionType","InteractionRequiredAuthError","loginRequest","ProfileData","Loading","ErrorComponent","callMsGraph","Paper","ProfileContent","instance","inProgress","graphData","setGraphData","None","then","response","catch","e","acquireTokenRedirect","account","getActiveAccount","Profile","authRequest","Redirect"],"sources":["/Users/andresz/Sandbox/reactjs/msal-react-typescript-sample/src/pages/Profile.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\n\n// Msal imports\nimport { MsalAuthenticationTemplate, useMsal } from \"@azure/msal-react\";\nimport { InteractionStatus, InteractionType, InteractionRequiredAuthError, AccountInfo } from \"@azure/msal-browser\";\nimport { loginRequest } from \"../authConfig\";\n\n// Sample app imports\nimport { ProfileData, GraphData } from \"../ui-components/ProfileData\";\nimport { Loading } from \"../ui-components/Loading\";\nimport { ErrorComponent } from \"../ui-components/ErrorComponent\";\nimport { callMsGraph } from \"../utils/MsGraphApiCall\";\n\n// Material-ui imports\nimport Paper from \"@material-ui/core/Paper\";\n\nconst ProfileContent = () => {\n    const { instance, inProgress } = useMsal();\n    const [graphData, setGraphData] = useState<null|GraphData>(null);\n\n    useEffect(() => {\n        if (!graphData && inProgress === InteractionStatus.None) {\n            callMsGraph().then(response => setGraphData(response)).catch((e) => {\n                if (e instanceof InteractionRequiredAuthError) {\n                    instance.acquireTokenRedirect({\n                        ...loginRequest,\n                        account: instance.getActiveAccount() as AccountInfo\n                    });\n                }\n            });\n        }\n    }, [inProgress, graphData, instance]);\n  \n    return (\n        <Paper>\n            { graphData ? <ProfileData graphData={graphData} /> : null }\n        </Paper>\n    );\n};\n\nexport function Profile() {\n    const authRequest = {\n        ...loginRequest\n    };\n\n    return (\n        <MsalAuthenticationTemplate \n            interactionType={InteractionType.Redirect} \n            authenticationRequest={authRequest} \n            errorComponent={ErrorComponent} \n            loadingComponent={Loading}\n        >\n            <ProfileContent />\n        </MsalAuthenticationTemplate>\n      )\n};"],"mappings":";;;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC,C,CAEA;;AACA,SAASC,0BAAT,EAAqCC,OAArC,QAAoD,mBAApD;AACA,SAASC,iBAAT,EAA4BC,eAA5B,EAA6CC,4BAA7C,QAA8F,qBAA9F;AACA,SAASC,YAAT,QAA6B,eAA7B,C,CAEA;;AACA,SAASC,WAAT,QAAuC,8BAAvC;AACA,SAASC,OAAT,QAAwB,0BAAxB;AACA,SAASC,cAAT,QAA+B,iCAA/B;AACA,SAASC,WAAT,QAA4B,yBAA5B,C,CAEA;;AACA,OAAOC,KAAP,MAAkB,yBAAlB;;;AAEA,MAAMC,cAAc,GAAG,MAAM;EAAA;;EACzB,MAAM;IAAEC,QAAF;IAAYC;EAAZ,IAA2BZ,OAAO,EAAxC;EACA,MAAM,CAACa,SAAD,EAAYC,YAAZ,IAA4BhB,QAAQ,CAAiB,IAAjB,CAA1C;EAEAD,SAAS,CAAC,MAAM;IACZ,IAAI,CAACgB,SAAD,IAAcD,UAAU,KAAKX,iBAAiB,CAACc,IAAnD,EAAyD;MACrDP,WAAW,GAAGQ,IAAd,CAAmBC,QAAQ,IAAIH,YAAY,CAACG,QAAD,CAA3C,EAAuDC,KAAvD,CAA8DC,CAAD,IAAO;QAChE,IAAIA,CAAC,YAAYhB,4BAAjB,EAA+C;UAC3CQ,QAAQ,CAACS,oBAAT,CAA8B,EAC1B,GAAGhB,YADuB;YAE1BiB,OAAO,EAAEV,QAAQ,CAACW,gBAAT;UAFiB,CAA9B;QAIH;MACJ,CAPD;IAQH;EACJ,CAXQ,EAWN,CAACV,UAAD,EAAaC,SAAb,EAAwBF,QAAxB,CAXM,CAAT;EAaA,oBACI,QAAC,KAAD;IAAA,UACME,SAAS,gBAAG,QAAC,WAAD;MAAa,SAAS,EAAEA;IAAxB;MAAA;MAAA;MAAA;IAAA,QAAH,GAA2C;EAD1D;IAAA;IAAA;IAAA;EAAA,QADJ;AAKH,CAtBD;;GAAMH,c;UAC+BV,O;;;KAD/BU,c;AAwBN,OAAO,SAASa,OAAT,GAAmB;EACtB,MAAMC,WAAW,GAAG,EAChB,GAAGpB;EADa,CAApB;EAIA,oBACI,QAAC,0BAAD;IACI,eAAe,EAAEF,eAAe,CAACuB,QADrC;IAEI,qBAAqB,EAAED,WAF3B;IAGI,cAAc,EAAEjB,cAHpB;IAII,gBAAgB,EAAED,OAJtB;IAAA,uBAMI,QAAC,cAAD;MAAA;MAAA;MAAA;IAAA;EANJ;IAAA;IAAA;IAAA;EAAA,QADJ;AAUH;MAfeiB,O;AAef"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"/*! @azure/msal-browser v2.28.2 2022-09-06 */\n'use strict';\n\nimport { __awaiter, __generator } from '../_virtual/_tslib.js';\nimport { Constants } from '@azure/msal-common';\nimport { BrowserAuthError } from '../error/BrowserAuthError.js';\nimport { HTTP_REQUEST_TYPE } from '../utils/BrowserConstants.js';\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * This class implements the Fetch API for GET and POST requests. See more here: https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\r\n */\n\nvar FetchClient =\n/** @class */\nfunction () {\n  function FetchClient() {}\n  /**\r\n   * Fetch Client for REST endpoints - Get request\r\n   * @param url\r\n   * @param headers\r\n   * @param body\r\n   */\n\n\n  FetchClient.prototype.sendGetRequestAsync = function (url, options) {\n    return __awaiter(this, void 0, void 0, function () {\n      var response, e_1, _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _b.trys.push([0, 2,, 3]);\n\n            return [4\n            /*yield*/\n            , fetch(url, {\n              method: HTTP_REQUEST_TYPE.GET,\n              headers: this.getFetchHeaders(options)\n            })];\n\n          case 1:\n            response = _b.sent();\n            return [3\n            /*break*/\n            , 3];\n\n          case 2:\n            e_1 = _b.sent();\n\n            if (window.navigator.onLine) {\n              throw BrowserAuthError.createGetRequestFailedError(e_1, url);\n            } else {\n              throw BrowserAuthError.createNoNetworkConnectivityError();\n            }\n\n          case 3:\n            _b.trys.push([3, 5,, 6]);\n\n            _a = {\n              headers: this.getHeaderDict(response.headers)\n            };\n            return [4\n            /*yield*/\n            , response.json()];\n\n          case 4:\n            return [2\n            /*return*/\n            , (_a.body = _b.sent(), _a.status = response.status, _a)];\n\n          case 5:\n            _b.sent();\n\n            throw BrowserAuthError.createFailedToParseNetworkResponseError(url);\n\n          case 6:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n  /**\r\n   * Fetch Client for REST endpoints - Post request\r\n   * @param url\r\n   * @param headers\r\n   * @param body\r\n   */\n\n\n  FetchClient.prototype.sendPostRequestAsync = function (url, options) {\n    return __awaiter(this, void 0, void 0, function () {\n      var reqBody, response, e_3, _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            reqBody = options && options.body || Constants.EMPTY_STRING;\n            _b.label = 1;\n\n          case 1:\n            _b.trys.push([1, 3,, 4]);\n\n            return [4\n            /*yield*/\n            , fetch(url, {\n              method: HTTP_REQUEST_TYPE.POST,\n              headers: this.getFetchHeaders(options),\n              body: reqBody\n            })];\n\n          case 2:\n            response = _b.sent();\n            return [3\n            /*break*/\n            , 4];\n\n          case 3:\n            e_3 = _b.sent();\n\n            if (window.navigator.onLine) {\n              throw BrowserAuthError.createPostRequestFailedError(e_3, url);\n            } else {\n              throw BrowserAuthError.createNoNetworkConnectivityError();\n            }\n\n          case 4:\n            _b.trys.push([4, 6,, 7]);\n\n            _a = {\n              headers: this.getHeaderDict(response.headers)\n            };\n            return [4\n            /*yield*/\n            , response.json()];\n\n          case 5:\n            return [2\n            /*return*/\n            , (_a.body = _b.sent(), _a.status = response.status, _a)];\n\n          case 6:\n            _b.sent();\n\n            throw BrowserAuthError.createFailedToParseNetworkResponseError(url);\n\n          case 7:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n  /**\r\n   * Get Fetch API Headers object from string map\r\n   * @param inputHeaders\r\n   */\n\n\n  FetchClient.prototype.getFetchHeaders = function (options) {\n    var headers = new Headers();\n\n    if (!(options && options.headers)) {\n      return headers;\n    }\n\n    var optionsHeaders = options.headers;\n    Object.keys(optionsHeaders).forEach(function (key) {\n      headers.append(key, optionsHeaders[key]);\n    });\n    return headers;\n  };\n\n  FetchClient.prototype.getHeaderDict = function (headers) {\n    var headerDict = {};\n    headers.forEach(function (value, key) {\n      headerDict[key] = value;\n    });\n    return headerDict;\n  };\n\n  return FetchClient;\n}();\n\nexport { FetchClient };","map":{"version":3,"mappings":";;;;;;;AAAA;;;;;AASA;;;;;;;EAGA,wBA4FC;;;;;;;;;EApFSA,4CAAN,UAA6BC,GAA7B,EAA0CC,OAA1C,EAAyE;;;;;;;;;YAGtD;YAAA;YAAA,EAAMC,KAAK,CAACF,GAAD,EAAM;cACxBG,MAAM,EAAEC,iBAAiB,CAACC,GADF;cAExBC,OAAO,EAAE,KAAKC,eAAL,CAAqBN,OAArB;YAFe,CAAN,CAAX;;;YAAXO,QAAQ,GAAGC,SAAX;;;;;;;;YAKA,IAAIC,MAAM,CAACC,SAAP,CAAiBC,MAArB,EAA6B;cACzB,MAAMC,gBAAgB,CAACC,2BAAjB,CAA6CC,GAA7C,EAAgDf,GAAhD,CAAN;YACH,CAFD,MAEO;cACH,MAAMa,gBAAgB,CAACG,gCAAjB,EAAN;YACH;;;;;;cAKGV,OAAO,EAAE,KAAKW,aAAL,CAAmBT,QAAQ,CAACF,OAA5B;;YACH;YAAA;YAAA,EAAME,QAAQ,CAACU,IAAT,EAAN;;;YAFV;YAAA;YAAA,GAEIC,UAAMV,SAAN,EACAU,YAAQX,QAAQ,CAACY,MADjB,IAFJ;;;;;YAMA,MAAMP,gBAAgB,CAACQ,uCAAjB,CAAyDrB,GAAzD,CAAN;;;;;;;;;EAEP,CAxBK;;;;;;;;;EAgCAD,6CAAN,UAA8BC,GAA9B,EAA2CC,OAA3C,EAA0E;;;;;;;YAChEqB,OAAO,GAAIrB,OAAO,IAAIA,OAAO,CAACsB,IAApB,IAA6BC,SAAS,CAACC,YAAjD;;;;;;YAIS;YAAA;YAAA,EAAMvB,KAAK,CAACF,GAAD,EAAM;cACxBG,MAAM,EAAEC,iBAAiB,CAACsB,IADF;cAExBpB,OAAO,EAAE,KAAKC,eAAL,CAAqBN,OAArB,CAFe;cAGxBsB,IAAI,EAAED;YAHkB,CAAN,CAAX;;;YAAXd,QAAQ,GAAGC,SAAX;;;;;;;;YAMA,IAAIC,MAAM,CAACC,SAAP,CAAiBC,MAArB,EAA6B;cACzB,MAAMC,gBAAgB,CAACc,4BAAjB,CAA8CC,GAA9C,EAAiD5B,GAAjD,CAAN;YACH,CAFD,MAEO;cACH,MAAMa,gBAAgB,CAACG,gCAAjB,EAAN;YACH;;;;;;cAKGV,OAAO,EAAE,KAAKW,aAAL,CAAmBT,QAAQ,CAACF,OAA5B;;YACH;YAAA;YAAA,EAAME,QAAQ,CAACU,IAAT,EAAN;;;YAFV;YAAA;YAAA,GAEIC,UAAMV,SAAN,EACAU,YAAQX,QAAQ,CAACY,MADjB,IAFJ;;;;;YAMA,MAAMP,gBAAgB,CAACQ,uCAAjB,CAAyDrB,GAAzD,CAAN;;;;;;;;;EAEP,CA3BK;;;;;;;EAiCED,wCAAR,UAAwBE,OAAxB,EAAuD;IACnD,IAAMK,OAAO,GAAG,IAAIuB,OAAJ,EAAhB;;IACA,IAAI,EAAE5B,OAAO,IAAIA,OAAO,CAACK,OAArB,CAAJ,EAAmC;MAC/B,OAAOA,OAAP;IACH;;IACD,IAAMwB,cAAc,GAAG7B,OAAO,CAACK,OAA/B;IACAyB,MAAM,CAACC,IAAP,CAAYF,cAAZ,EAA4BG,OAA5B,CAAoC,UAACC,GAAD,EAAI;MACpC5B,OAAO,CAAC6B,MAAR,CAAeD,GAAf,EAAoBJ,cAAc,CAACI,GAAD,CAAlC;IACH,CAFD;IAGA,OAAO5B,OAAP;EACH,CAVO;;EAYAP,sCAAR,UAAsBO,OAAtB,EAAsC;IAClC,IAAM8B,UAAU,GAA2B,EAA3C;IACA9B,OAAO,CAAC2B,OAAR,CAAgB,UAACI,KAAD,EAAgBH,GAAhB,EAA2B;MACvCE,UAAU,CAACF,GAAD,CAAV,GAAkBG,KAAlB;IACH,CAFD;IAGA,OAAOD,UAAP;EACH,CANO;;EAOZ;AAAC","names":["FetchClient","url","options","fetch","method","HTTP_REQUEST_TYPE","GET","headers","getFetchHeaders","response","_b","window","navigator","onLine","BrowserAuthError","createGetRequestFailedError","e_1","createNoNetworkConnectivityError","getHeaderDict","json","_a","status","createFailedToParseNetworkResponseError","reqBody","body","Constants","EMPTY_STRING","POST","createPostRequestFailedError","e_3","Headers","optionsHeaders","Object","keys","forEach","key","append","headerDict","value"],"sources":["../../src/network/FetchClient.ts"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { Constants, INetworkModule, NetworkRequestOptions, NetworkResponse } from \"@azure/msal-common\";\nimport { BrowserAuthError } from \"../error/BrowserAuthError\";\nimport { HTTP_REQUEST_TYPE } from \"../utils/BrowserConstants\";\n\n/**\n * This class implements the Fetch API for GET and POST requests. See more here: https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\n */\nexport class FetchClient implements INetworkModule {\n\n    /**\n     * Fetch Client for REST endpoints - Get request\n     * @param url \n     * @param headers \n     * @param body \n     */\n    async sendGetRequestAsync<T>(url: string, options?: NetworkRequestOptions): Promise<NetworkResponse<T>> {\n        let response;\n        try {\n            response = await fetch(url, {\n                method: HTTP_REQUEST_TYPE.GET,\n                headers: this.getFetchHeaders(options)\n            });\n        } catch (e) {\n            if (window.navigator.onLine) {\n                throw BrowserAuthError.createGetRequestFailedError(e, url);\n            } else {\n                throw BrowserAuthError.createNoNetworkConnectivityError();\n            }\n        }\n\n        try {\n            return {\n                headers: this.getHeaderDict(response.headers),\n                body: await response.json() as T,\n                status: response.status\n            };\n        } catch (e) {\n            throw BrowserAuthError.createFailedToParseNetworkResponseError(url);\n        }\n    }\n\n    /**\n     * Fetch Client for REST endpoints - Post request\n     * @param url \n     * @param headers \n     * @param body \n     */\n    async sendPostRequestAsync<T>(url: string, options?: NetworkRequestOptions): Promise<NetworkResponse<T>> {\n        const reqBody = (options && options.body) || Constants.EMPTY_STRING;\n\n        let response;\n        try {\n            response = await fetch(url, {\n                method: HTTP_REQUEST_TYPE.POST,\n                headers: this.getFetchHeaders(options),\n                body: reqBody\n            });\n        } catch (e) {\n            if (window.navigator.onLine) {\n                throw BrowserAuthError.createPostRequestFailedError(e, url);\n            } else {\n                throw BrowserAuthError.createNoNetworkConnectivityError();\n            }\n        }\n\n        try {\n            return {\n                headers: this.getHeaderDict(response.headers),\n                body: await response.json() as T,\n                status: response.status\n            };\n        } catch (e) {\n            throw BrowserAuthError.createFailedToParseNetworkResponseError(url);\n        }\n    }\n\n    /**\n     * Get Fetch API Headers object from string map\n     * @param inputHeaders \n     */\n    private getFetchHeaders(options?: NetworkRequestOptions): Headers {\n        const headers = new Headers();\n        if (!(options && options.headers)) {\n            return headers;\n        }\n        const optionsHeaders = options.headers;\n        Object.keys(optionsHeaders).forEach((key) => {\n            headers.append(key, optionsHeaders[key]);\n        });\n        return headers;\n    }\n\n    private getHeaderDict(headers: Headers): Record<string, string> {\n        const headerDict: Record<string, string> = {};\n        headers.forEach((value: string, key: string) => {\n            headerDict[key] = value;\n        });\n        return headerDict;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}
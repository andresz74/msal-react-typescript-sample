{"ast":null,"code":"import { loginRequest, graphConfig } from \"../authConfig\";\nimport { msalInstance } from \"../index\";\nexport async function callMsGraph() {\n  const account = msalInstance.getActiveAccount();\n\n  if (!account) {\n    throw Error(\"No active account! Verify a user has been signed in and setActiveAccount has been called.\");\n  }\n\n  const response = await msalInstance.acquireTokenSilent({ ...loginRequest,\n    account: account\n  });\n  const headers = new Headers();\n  const bearer = `Bearer ${response.accessToken}`;\n  headers.append(\"Authorization\", bearer);\n  const options = {\n    method: \"GET\",\n    headers: headers\n  };\n  return fetch(graphConfig.graphMeEndpoint, options).then(response => response.json()).catch(error => console.log(error));\n}","map":{"version":3,"names":["loginRequest","graphConfig","msalInstance","callMsGraph","account","getActiveAccount","Error","response","acquireTokenSilent","headers","Headers","bearer","accessToken","append","options","method","fetch","graphMeEndpoint","then","json","catch","error","console","log"],"sources":["/Users/andresz/Sandbox/reactjs/msal-react-typescript-sample/src/utils/MsGraphApiCall.ts"],"sourcesContent":["import { loginRequest, graphConfig } from \"../authConfig\";\nimport { msalInstance } from \"../index\";\n\nexport async function callMsGraph() {\n    const account = msalInstance.getActiveAccount();\n    if (!account) {\n        throw Error(\"No active account! Verify a user has been signed in and setActiveAccount has been called.\");\n    }\n\n    const response = await msalInstance.acquireTokenSilent({\n        ...loginRequest,\n        account: account\n    });\n\n    const headers = new Headers();\n    const bearer = `Bearer ${response.accessToken}`;\n\n    headers.append(\"Authorization\", bearer);\n\n    const options = {\n        method: \"GET\",\n        headers: headers\n    };\n\n    return fetch(graphConfig.graphMeEndpoint, options)\n        .then(response => response.json())\n        .catch(error => console.log(error));\n}"],"mappings":"AAAA,SAASA,YAAT,EAAuBC,WAAvB,QAA0C,eAA1C;AACA,SAASC,YAAT,QAA6B,UAA7B;AAEA,OAAO,eAAeC,WAAf,GAA6B;EAChC,MAAMC,OAAO,GAAGF,YAAY,CAACG,gBAAb,EAAhB;;EACA,IAAI,CAACD,OAAL,EAAc;IACV,MAAME,KAAK,CAAC,2FAAD,CAAX;EACH;;EAED,MAAMC,QAAQ,GAAG,MAAML,YAAY,CAACM,kBAAb,CAAgC,EACnD,GAAGR,YADgD;IAEnDI,OAAO,EAAEA;EAF0C,CAAhC,CAAvB;EAKA,MAAMK,OAAO,GAAG,IAAIC,OAAJ,EAAhB;EACA,MAAMC,MAAM,GAAI,UAASJ,QAAQ,CAACK,WAAY,EAA9C;EAEAH,OAAO,CAACI,MAAR,CAAe,eAAf,EAAgCF,MAAhC;EAEA,MAAMG,OAAO,GAAG;IACZC,MAAM,EAAE,KADI;IAEZN,OAAO,EAAEA;EAFG,CAAhB;EAKA,OAAOO,KAAK,CAACf,WAAW,CAACgB,eAAb,EAA8BH,OAA9B,CAAL,CACFI,IADE,CACGX,QAAQ,IAAIA,QAAQ,CAACY,IAAT,EADf,EAEFC,KAFE,CAEIC,KAAK,IAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAFb,CAAP;AAGH"},"metadata":{},"sourceType":"module"}